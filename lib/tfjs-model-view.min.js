!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("tfjs-model-view",[],t):"object"==typeof exports?exports["tfjs-model-view"]=t():e["tfjs-model-view"]=t()}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(1)),o=i(r(2)),a=i(r(4));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=Object.assign({},a.default,r),u=i.onRendererInitialized,s=void 0;i.predictCallback=function(e){s&&(s.update(t,e),s.render())},i.hookCallback=function(e){s&&(s.updateValues(e),s.render())},(0,n.default)(t,i).then((function(e){s=new o.default(i,e),u&&u(s)}))},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=(n=i(regeneratorRuntime.mark((function e(t,r){var n,a,s,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function e(t,r){var o,s=this,c=t.name,l=t.input,f=t.inputs,d=t.shape,p=t.sourceLayer,h=p||{},y=h.getWeights,v=h.setCallHook,g=h.activation,b={previousColumn:[],name:c,shape:d,weights:{},getWeights:u,mapPosition:Object.keys(n.layerMap).length};if(n.layerMap[c]=b,n.layerArr.unshift(b),g){var m=g.getClassName();b.activation={name:m}}return v&&p.setCallHook((o=i(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(b.getWeights(),b.activations=[],r=0;r<t.length;r++)b.activations.push(t[r].dataSync());a.hookCallback(b);case 4:case"end":return e.stop()}}),e,s)}))),function(e){return o.apply(this,arguments)})),y&&(b.getWeights=i(regeneratorRuntime.mark((function e(){var t,r,n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.getWeights();case 2:t=e.sent,r=0;case 4:if(!(r<t.length)){e.next=16;break}return n=t[r],o=n.rankType,a=n.name,b.hasWeights=!0,e.t0=a,e.next=11,t[r].dataSync();case 11:e.t1=e.sent,b.weights[o]={name:e.t0,values:e.t1};case 13:r++,e.next=4;break;case 16:case"end":return e.stop()}}),e,s)}))),b.getWeights()),f?f.forEach((function(t){e(t,b.previousColumn)})):e(l,b.previousColumn),r&&r.push(b),b},n={layerMap:{},layerArr:[]},a=o({predictCallback:u,hookCallback:u},r),c=t.predict,t.predict=function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];var o=c.apply(t,r);return t.outputData=o.dataSync(),a.predictCallback(r),o},e.next=7,s(t.layers[t.layers.length-1].output);case 7:return n.model=e.sent,r.printStats&&(l=n.layerArr,console.log(new Array(10).join("-")),l.forEach((function(e){console.log("Layer: "+e.name)}))),e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)});function i(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,r){return function n(o,a){try{var i=t[o](a),u=i.value}catch(e){return void r(e)}if(!i.done)return Promise.resolve(u).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(u)}("next")}))}}function u(){}t.default=a,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(3);var u=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),o=document.createElement("canvas"),a=e.onBeginRender,i=e.onEndRender;return Object.assign(n,{canvas:o,onBeginRender:a,onEndRender:i}),o.setAttribute("width",n.width),o.setAttribute("height",n.height),n.renderContext=o.getContext("2d"),n.renderElement=o,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this;window.requestAnimationFrame((function(){var t=e.onBeginRender,r=e.onEndRender;e.renderContext.clearRect(0,0,e.width,e.height),t&&t(e),e.layers.forEach((function(t){var r=t.radius,n=t.nodes,a=o(t.domain,2),i=a[0],u=a[1],s=t.previousColumn,c=t.renderLinks,l=t.renderNode,f=t.weights,d=o(t.color,3),p=d[0],h=d[1],y=d[2],v=t.nodeStroke,g=f[2],b=void 0;c&&(b=s.reduce((function(e,t){return e.concat(t.nodes)}),[])),n.forEach((function(t,n){var o=t.x,a=t.y,s=t.value;c&&b.forEach((function(r,o){e.renderContext.beginPath();var a=g&&g.values,i=a?g.values[n*o]:.5;e.renderContext.strokeStyle=a?i>0?"rgb(0, 0, 255, "+i+")":"rgb(255, 0, 0, "+Math.abs(i)+")":"rgba(0,0,0,.5)",e.renderContext.moveTo(r.x+r.radius/2,r.y),e.renderContext.lineTo(t.x-t.radius/2,t.y),e.renderContext.stroke()})),e.renderContext.strokeStyle="rgb("+p+", "+h+", "+y+")";var f=s/(u+i);isNaN(f)?e.renderContext.fillStyle="#FFF":e.renderContext.fillStyle="rgba("+p+", "+h+", "+y+", "+f+")",e.renderContext.beginPath(),e.renderContext.arc(o,a,r/2,0,2*Math.PI),r>3&&v&&e.renderContext.stroke(),e.renderContext.fill(),l&&l(e.renderContext,t,n)}))})),r&&r(e)}))}}]),t}(((n=i)&&n.__esModule?n:{default:n}).default);t.default=u,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var a=[[6,57,143],[0,107,92],[216,139,0],[180,0,85],[106,2,143],[216,109,0],[2,105,134],[0,142,103],[201,0,39],[139,11,215],[171,141,0]],i=function(){function e(t,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=t.xPadding,u=t.yPadding,s=t.xOffset,c=t.layer,l=void 0===c?{}:c,f=r.layerArr,d=2*(u||1),p=(i||0)+(s||0);!function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.column=r,t.previousColumn.forEach((function(t){e(t,r+1)}))}(f[f.length-1]),f.forEach((function(e,r){var i=e.name,u=e.shape,s=e.previousColumn;o.outputLayer=e;var c=l[i]||{},f=Object.assign({},t,c),h=f.radius,y=f.nodePadding,v=f.layerPadding,g=f.groupPadding,b=f.domain,m=void 0===b?[0,1]:b,x=f.renderLinks,w=f.renderNode,j=f.nodeStroke,k=f.reshape,C=f.color||(r<a.length?a[r]:[0,0,0]),O=Object.assign([1,1,1],u.slice(1)),P=n(O,3),_=P[0],E=P[1],S=P[2],M=_*E*S;if(k){var R=Object.assign([1,1,1],k),A=n(R,3),L=A[0],T=A[1],W=A[2];if(L*T*W!==M)throw new Error("Unable to reshape from ["+_+", "+E+", "+S+"] to ["+L+", "+T+", "+W+"]");_=L,E=T,S=W}p+=v;for(var N=h+y,V=v+E*N,I=[],F=0,H=0;H<_;H++)for(var B=0;B<E;B++)for(var z=0;z<S;z++){var D=h+H*N+z*_*N+z*g;I.push({x:p+B*N,y:D,radius:h}),F=D}F+=g+h,d=Math.max(d,F),Object.assign(e,{name:i,x:p,layerWidth:V,layerHeight:F,radius:h,nodes:I,domain:m,renderLinks:x,renderNode:w,nodeStroke:j,color:C,previousLayers:s.map((function(e){return e.name}))}),p+=V})),p+=i||0,f.forEach((function(e){var t=Math.floor((d-e.layerHeight)/2);e.nodes.forEach((function(e){return e.y+=t}))})),Object.assign(this,{width:p,height:d}),this.layers=f,this.layersMap=f.reduce((function(e,t){return e[t.name]=t,e}),{})}return o(e,[{key:"update",value:function(e,t){var r=this;t&&e.inputs.forEach((function(e,n){var o=r.layersMap[e.name];r.updateLayerValues(o,t[n].dataSync())})),this.updateLayerValues(this.outputLayer,e.outputData)}},{key:"updateLayerValues",value:function(e,t){for(var r=0;r<e.nodes.length;r++)e.nodes[r].value=t[r]}},{key:"updateValues",value:function(e){var t=this,r=this.layersMap[e.name];r.weights=e.weights,r.previousColumn.forEach((function(r,n){t.updateLayerValues(r,e.activations[n])}))}}]),e}();t.default=i,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={renderer:"canvas",radius:6,nodePadding:2,layerPadding:20,groupPadding:1,xPadding:10,yPadding:10,renderLinks:!1,plotActivations:!1,nodeStroke:!0,onRendererInitialized:function(e){document.body.appendChild(e.canvas)}},e.exports=t.default}])}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZmpzLW1vZGVsLXZpZXcvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL3RmanMtbW9kZWwtdmlldy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly90ZmpzLW1vZGVsLXZpZXcvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdGZqcy1tb2RlbC12aWV3Ly4vc3JjL21vZGVsLXBhcnNlci5qcyIsIndlYnBhY2s6Ly90ZmpzLW1vZGVsLXZpZXcvLi9zcmMvcmVuZGVyZXJzL2NhbnZhcy5yZW5kZXJlci5qcyIsIndlYnBhY2s6Ly90ZmpzLW1vZGVsLXZpZXcvLi9zcmMvcmVuZGVyZXJzL2Fic3RyYWN0LnJlbmRlcmVyLmpzIiwid2VicGFjazovL3RmanMtbW9kZWwtdmlldy8uL3NyYy9kZWZhdWx0LmNvbmZpZy5qcyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJzZWxmIiwidGhpcyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJtb2RlbCIsImN1c3RvbUNvbmZpZyIsImNvbmZpZyIsImFzc2lnbiIsImRlZmF1bHRDb25maWciLCJvblJlbmRlcmVySW5pdGlhbGl6ZWQiLCJyZW5kZXJlciIsInByZWRpY3RDYWxsYmFjayIsImlucHV0IiwidXBkYXRlIiwicmVuZGVyIiwiaG9va0NhbGxiYWNrIiwibGF5ZXIiLCJ1cGRhdGVWYWx1ZXMiLCJ0aGVuIiwicmVzIiwiQ2FudmFzUmVuZGVyZXIiLCJvcHRpb25zIiwicGFyc2VMYXllciIsIm5leHRDb2x1bW4iLCJpbnB1dHMiLCJzaGFwZSIsInNvdXJjZUxheWVyIiwiZ2V0V2VpZ2h0cyIsInNldENhbGxIb29rIiwiYWN0aXZhdGlvbiIsImN1cnJlbnRMYXllciIsInByZXZpb3VzQ29sdW1uIiwid2VpZ2h0cyIsIm5vb3AiLCJtYXBQb3NpdGlvbiIsImtleXMiLCJwYXJzZWQiLCJsYXllck1hcCIsImxlbmd0aCIsImxheWVyQXJyIiwidW5zaGlmdCIsImNsYXNzTmFtZSIsImdldENsYXNzTmFtZSIsImxheWVySW5wdXQiLCJhY3RpdmF0aW9ucyIsInB1c2giLCJkYXRhU3luYyIsInBhcnNlckNvbmZpZyIsIndlaWdodCIsInJhbmtUeXBlIiwid2VpZ2h0TmFtZSIsImhhc1dlaWdodHMiLCJ2YWx1ZXMiLCJmb3JFYWNoIiwiaW5wIiwicHJlZGljdCIsImFyZ3MiLCJyZXN1bHQiLCJhcHBseSIsIm91dHB1dERhdGEiLCJsYXllcnMiLCJvdXRwdXQiLCJwcmludFN0YXRzIiwiY29uc29sZSIsImxvZyIsIkFycmF5Iiwiam9pbiIsInBhcnNlTW9kZWwiLCJpbml0RGF0YSIsImNhbnZhcyIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsIm9uQmVnaW5SZW5kZXIiLCJvbkVuZFJlbmRlciIsInNldEF0dHJpYnV0ZSIsIndpZHRoIiwiaGVpZ2h0IiwicmVuZGVyQ29udGV4dCIsImdldENvbnRleHQiLCJyZW5kZXJFbGVtZW50Iiwid2luZG93IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiY2xlYXJSZWN0IiwicmFkaXVzIiwibm9kZXMiLCJkb21haW4iLCJtaW4iLCJtYXgiLCJyZW5kZXJMaW5rcyIsInJlbmRlck5vZGUiLCJjb2xvciIsImciLCJiIiwibm9kZVN0cm9rZSIsImtlcm5lbCIsImxlZnRTaWRlTm9kZXMiLCJyZWR1Y2UiLCJtZW1vIiwicHJldkxheWVyIiwiY29uY2F0Iiwibm9kZSIsImluZGV4IiwibngiLCJ4IiwibnkiLCJ5IiwibGVmdE5vZGUiLCJsZWZ0SWR4IiwiYmVnaW5QYXRoIiwiaGFzV2VpZ2h0Iiwid2VpZ2h0VmFsIiwic3Ryb2tlU3R5bGUiLCJNYXRoIiwiYWJzIiwibW92ZVRvIiwibGluZVRvIiwic3Ryb2tlIiwiZG9tYWluVmFsdWUiLCJpc05hTiIsImZpbGxTdHlsZSIsImFyYyIsIlBJIiwiZmlsbCIsIkFic3RyYWN0UmVuZGVyZXIiLCJjb2xvcnMiLCJ4UGFkZGluZyIsInlQYWRkaW5nIiwieE9mZnNldCIsIm1heEhlaWdodCIsImN4IiwicHJvY2Vzc0NvbHVtbiIsImx5ciIsImNvbCIsImNvbHVtbiIsImxpbmRleCIsIm91dHB1dExheWVyIiwibGF5ZXJDb25maWciLCJub2RlUGFkZGluZyIsImxheWVyUGFkZGluZyIsImdyb3VwUGFkZGluZyIsInJlc2hhcGUiLCJzbGljZSIsInJvd3MiLCJjb2xzIiwiZ3JvdXBzIiwidG90YWxOb2RlcyIsIm5yIiwibmMiLCJuZyIsIkVycm9yIiwic3RlcCIsInJvdyIsImdyb3VwIiwibGF5ZXJXaWR0aCIsImxheWVySGVpZ2h0IiwicHJldmlvdXNMYXllcnMiLCJtYXAiLCJvZmZzZXRZIiwiZmxvb3IiLCJuZCIsImxheWVyc01hcCIsIml0ZW0iLCJpbnB1dExheWVyIiwic3ludGhldGljTGF5ZXIiLCJ1cGRhdGVMYXllclZhbHVlcyIsImRhdGEiLCJpZHgiLCJwbG90QWN0aXZhdGlvbnMiLCJib2R5IiwiYXBwZW5kQ2hpbGQiXSwibWFwcGluZ3MiOiJDQUFBLFNBQTJDQSxFQUFNQyxHQUMxQixpQkFBWkMsU0FBMEMsaUJBQVhDLE9BQ3hDQSxPQUFPRCxRQUFVRCxJQUNRLG1CQUFYRyxRQUF5QkEsT0FBT0MsSUFDOUNELE9BQU8sa0JBQW1CLEdBQUlILEdBQ0osaUJBQVpDLFFBQ2RBLFFBQVEsbUJBQXFCRCxJQUU3QkQsRUFBSyxt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b24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShcInRmanMtbW9kZWwtdmlld1wiLCBbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJ0ZmpzLW1vZGVsLXZpZXdcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1widGZqcy1tb2RlbC12aWV3XCJdID0gZmFjdG9yeSgpO1xufSkodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuICIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImltcG9ydCBwYXJzZU1vZGVsIGZyb20gJy4vbW9kZWwtcGFyc2VyJztcbmltcG9ydCBDYW52YXNSZW5kZXJlciBmcm9tICcuL3JlbmRlcmVycy9jYW52YXMucmVuZGVyZXInO1xuaW1wb3J0IGRlZmF1bHRDb25maWcgZnJvbSAnLi9kZWZhdWx0LmNvbmZpZyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGVsVmlldyB7XG5cbiAgICBjb25zdHJ1Y3Rvcihtb2RlbCwgY3VzdG9tQ29uZmlnKSB7XG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRDb25maWcsIGN1c3RvbUNvbmZpZyk7XG4gICAgICAgIGNvbnN0IHsgb25SZW5kZXJlckluaXRpYWxpemVkIH0gPSBjb25maWc7XG4gICAgICAgIGxldCByZW5kZXJlcjtcblxuICAgICAgICBjb25maWcucHJlZGljdENhbGxiYWNrID0gaW5wdXQgPT4ge1xuICAgICAgICAgICAgaWYgKHJlbmRlcmVyKSB7XG4gICAgICAgICAgICAgICAgcmVuZGVyZXIudXBkYXRlKG1vZGVsLCBpbnB1dCk7XG4gICAgICAgICAgICAgICAgcmVuZGVyZXIucmVuZGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25maWcuaG9va0NhbGxiYWNrID0gbGF5ZXIgPT4ge1xuICAgICAgICAgICAgaWYgKHJlbmRlcmVyKSB7XG4gICAgICAgICAgICAgICAgcmVuZGVyZXIudXBkYXRlVmFsdWVzKGxheWVyKTtcbiAgICAgICAgICAgICAgICByZW5kZXJlci5yZW5kZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHBhcnNlTW9kZWwobW9kZWwsIGNvbmZpZykudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgcmVuZGVyZXIgPSBuZXcgQ2FudmFzUmVuZGVyZXIoY29uZmlnLCByZXMpO1xuICAgICAgICAgICAgaWYgKG9uUmVuZGVyZXJJbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgIG9uUmVuZGVyZXJJbml0aWFsaXplZChyZW5kZXJlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiIsImZ1bmN0aW9uIG5vb3AoKSB7IH1cblxuYXN5bmMgZnVuY3Rpb24gcGFyc2VNb2RlbChtb2RlbCwgb3B0aW9ucykge1xuXG4gIGNvbnN0IHBhcnNlZCA9IHtcbiAgICBsYXllck1hcDoge30sXG4gICAgbGF5ZXJBcnI6IFtdXG4gIH07XG5cbiAgY29uc3QgcGFyc2VyQ29uZmlnID0ge1xuICAgIHByZWRpY3RDYWxsYmFjazogbm9vcCxcbiAgICBob29rQ2FsbGJhY2s6IG5vb3AsXG4gICAgLi4ub3B0aW9uc1xuICB9XG5cbiAgZnVuY3Rpb24gcGFyc2VMYXllcihsYXllciwgbmV4dENvbHVtbikge1xuXG4gICAgY29uc3Qge1xuICAgICAgbmFtZSxcbiAgICAgIGlucHV0LFxuICAgICAgaW5wdXRzLFxuICAgICAgc2hhcGUsXG4gICAgICBzb3VyY2VMYXllclxuICAgIH0gPSBsYXllcjtcblxuICAgIGNvbnN0IHtcbiAgICAgIGdldFdlaWdodHMsXG4gICAgICBzZXRDYWxsSG9vayxcbiAgICAgIGFjdGl2YXRpb25cbiAgICB9ID0gc291cmNlTGF5ZXIgfHwge307XG5cbiAgICBjb25zdCBjdXJyZW50TGF5ZXIgPSB7XG4gICAgICBwcmV2aW91c0NvbHVtbjogW10sXG4gICAgICBuYW1lLFxuICAgICAgc2hhcGUsXG4gICAgICB3ZWlnaHRzOiB7fSxcbiAgICAgIGdldFdlaWdodHM6IG5vb3AsXG4gICAgICBtYXBQb3NpdGlvbjogT2JqZWN0LmtleXMocGFyc2VkLmxheWVyTWFwKS5sZW5ndGhcbiAgICB9O1xuXG4gICAgcGFyc2VkLmxheWVyTWFwW25hbWVdID0gY3VycmVudExheWVyO1xuICAgIHBhcnNlZC5sYXllckFyci51bnNoaWZ0KGN1cnJlbnRMYXllcik7XG5cbiAgICBpZiAoYWN0aXZhdGlvbikge1xuICAgICAgbGV0IGNsYXNzTmFtZSA9IGFjdGl2YXRpb24uZ2V0Q2xhc3NOYW1lKCk7XG4gICAgICBjdXJyZW50TGF5ZXIuYWN0aXZhdGlvbiA9IHtcbiAgICAgICAgbmFtZTogY2xhc3NOYW1lXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHNldENhbGxIb29rKSB7XG4gICAgICBzb3VyY2VMYXllci5zZXRDYWxsSG9vayhhc3luYyBsYXllcklucHV0ID0+IHtcbiAgICAgICAgY3VycmVudExheWVyLmdldFdlaWdodHMoKTtcbiAgICAgICAgY3VycmVudExheWVyLmFjdGl2YXRpb25zID0gW11cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsYXllcklucHV0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY3VycmVudExheWVyLmFjdGl2YXRpb25zLnB1c2gobGF5ZXJJbnB1dFtpXS5kYXRhU3luYygpKVxuICAgICAgICB9XG4gICAgICAgIHBhcnNlckNvbmZpZy5ob29rQ2FsbGJhY2soY3VycmVudExheWVyKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChnZXRXZWlnaHRzKSB7XG5cbiAgICAgIGN1cnJlbnRMYXllci5nZXRXZWlnaHRzID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCB3ZWlnaHRzID0gYXdhaXQgc291cmNlTGF5ZXIuZ2V0V2VpZ2h0cygpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd2VpZ2h0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNvbnN0IHdlaWdodCA9IHdlaWdodHNbaV07XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgcmFua1R5cGUsXG4gICAgICAgICAgICBuYW1lOiB3ZWlnaHROYW1lXG4gICAgICAgICAgfSA9IHdlaWdodDtcbiAgICAgICAgICBjdXJyZW50TGF5ZXIuaGFzV2VpZ2h0cyA9IHRydWU7XG4gICAgICAgICAgY3VycmVudExheWVyLndlaWdodHNbcmFua1R5cGVdID0ge1xuICAgICAgICAgICAgbmFtZTogd2VpZ2h0TmFtZSxcbiAgICAgICAgICAgIHZhbHVlczogYXdhaXQgd2VpZ2h0c1tpXS5kYXRhU3luYygpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGN1cnJlbnRMYXllci5nZXRXZWlnaHRzKCk7XG4gICAgfVxuXG4gICAgaWYgKGlucHV0cykge1xuICAgICAgaW5wdXRzLmZvckVhY2goaW5wID0+IHtcbiAgICAgICAgcGFyc2VMYXllcihpbnAsIGN1cnJlbnRMYXllci5wcmV2aW91c0NvbHVtbik7XG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICBwYXJzZUxheWVyKGlucHV0LCBjdXJyZW50TGF5ZXIucHJldmlvdXNDb2x1bW4pO1xuICAgIH1cblxuICAgIGlmIChuZXh0Q29sdW1uKSB7XG4gICAgICBuZXh0Q29sdW1uLnB1c2goY3VycmVudExheWVyKTtcbiAgICB9XG5cbiAgICByZXR1cm4gY3VycmVudExheWVyO1xuICB9XG5cbiAgY29uc3QgcHJlZGljdCA9IG1vZGVsLnByZWRpY3Q7XG5cbiAgbW9kZWwucHJlZGljdCA9ICguLi5hcmdzKSA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0gcHJlZGljdC5hcHBseShtb2RlbCwgYXJncyk7XG4gICAgbW9kZWwub3V0cHV0RGF0YSA9IHJlc3VsdC5kYXRhU3luYygpO1xuICAgIHBhcnNlckNvbmZpZy5wcmVkaWN0Q2FsbGJhY2soYXJncyk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBwYXJzZWQubW9kZWwgPSBhd2FpdCBwYXJzZUxheWVyKG1vZGVsLmxheWVyc1ttb2RlbC5sYXllcnMubGVuZ3RoIC0gMV0ub3V0cHV0KTtcblxuICBpZiAob3B0aW9ucy5wcmludFN0YXRzKSB7XG4gICAgY29uc3Qge1xuICAgICAgbGF5ZXJBcnJcbiAgICB9ID0gcGFyc2VkO1xuICAgIGNvbnNvbGUubG9nKG5ldyBBcnJheSgxMCkuam9pbignLScpKTtcbiAgICBsYXllckFyci5mb3JFYWNoKGxheWVyID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGBMYXllcjogJHtsYXllci5uYW1lfWApO1xuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHBhcnNlZDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgcGFyc2VNb2RlbDtcbiIsImltcG9ydCBBYnN0cmFjdFJlbmRlcmVyIGZyb20gJy4vYWJzdHJhY3QucmVuZGVyZXInO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYW52YXNSZW5kZXJlciBleHRlbmRzIEFic3RyYWN0UmVuZGVyZXIge1xuICAgIGNvbnN0cnVjdG9yKGNvbmZpZywgaW5pdERhdGEpIHtcbiAgICAgICAgc3VwZXIoY29uZmlnLCBpbml0RGF0YSk7XG4gICAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuXG4gICAgICAgIGNvbnN0IHsgb25CZWdpblJlbmRlciwgb25FbmRSZW5kZXIgfSA9IGNvbmZpZztcblxuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMsIHsgY2FudmFzLCBvbkJlZ2luUmVuZGVyLCBvbkVuZFJlbmRlciB9KVxuXG4gICAgICAgIGNhbnZhcy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgdGhpcy53aWR0aCk7XG4gICAgICAgIGNhbnZhcy5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsIHRoaXMuaGVpZ2h0KTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMucmVuZGVyQ29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpXG4gICAgICAgIHRoaXMucmVuZGVyRWxlbWVudCA9IGNhbnZhcztcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgeyBvbkJlZ2luUmVuZGVyLCBvbkVuZFJlbmRlciB9ID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMucmVuZGVyQ29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xuXG4gICAgICAgICAgICBpZiAob25CZWdpblJlbmRlcikge1xuICAgICAgICAgICAgICAgIG9uQmVnaW5SZW5kZXIodGhpcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMubGF5ZXJzLmZvckVhY2gobGF5ZXIgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgICAgICAgICAgcmFkaXVzLFxuICAgICAgICAgICAgICAgICAgICBub2RlcyxcbiAgICAgICAgICAgICAgICAgICAgZG9tYWluOiBbbWluLCBtYXhdLFxuICAgICAgICAgICAgICAgICAgICBwcmV2aW91c0NvbHVtbixcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyTGlua3MsXG4gICAgICAgICAgICAgICAgICAgIHJlbmRlck5vZGUsXG4gICAgICAgICAgICAgICAgICAgIHdlaWdodHMsXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiBbciwgZywgYl0sXG4gICAgICAgICAgICAgICAgICAgIG5vZGVTdHJva2VcbiAgICAgICAgICAgICAgICB9ID0gbGF5ZXI7XG5cbiAgICAgICAgICAgICAgICBsZXQgeyAyOiBrZXJuZWwgfSA9IHdlaWdodHM7XG4gICAgICAgICAgICAgICAgbGV0IGxlZnRTaWRlTm9kZXM7XG5cbiAgICAgICAgICAgICAgICBpZiAocmVuZGVyTGlua3MpIHtcbiAgICAgICAgICAgICAgICAgICAgbGVmdFNpZGVOb2RlcyA9IHByZXZpb3VzQ29sdW1uLnJlZHVjZSgobWVtbywgcHJldkxheWVyKSA9PiBtZW1vLmNvbmNhdChwcmV2TGF5ZXIubm9kZXMpLCBbXSlcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBub2Rlcy5mb3JFYWNoKChub2RlLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB7IHg6IG54LCB5OiBueSwgdmFsdWUgfSA9IG5vZGU7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbmRlckxpbmtzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0U2lkZU5vZGVzLmZvckVhY2goKGxlZnROb2RlLCBsZWZ0SWR4KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJDb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBoYXNXZWlnaHQgPSBrZXJuZWwgJiYga2VybmVsLnZhbHVlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB3ZWlnaHRWYWwgPSBoYXNXZWlnaHQgPyBrZXJuZWwudmFsdWVzW2luZGV4ICogbGVmdElkeF0gOiAwLjVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzV2VpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyQ29udGV4dC5zdHJva2VTdHlsZSA9IHdlaWdodFZhbCA+IDAgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYHJnYigwLCAwLCAyNTUsICR7d2VpZ2h0VmFsfSlgIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGByZ2IoMjU1LCAwLCAwLCAke01hdGguYWJzKHdlaWdodFZhbCl9KWA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJDb250ZXh0LnN0cm9rZVN0eWxlID0gJ3JnYmEoMCwwLDAsLjUpJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJDb250ZXh0Lm1vdmVUbyhsZWZ0Tm9kZS54ICsgbGVmdE5vZGUucmFkaXVzIC8gMiwgbGVmdE5vZGUueSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJDb250ZXh0LmxpbmVUbyhub2RlLnggLSBub2RlLnJhZGl1cyAvIDIsIG5vZGUueSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJDb250ZXh0LnN0cm9rZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckNvbnRleHQuc3Ryb2tlU3R5bGUgPSBgcmdiKCR7cn0sICR7Z30sICR7Yn0pYDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZG9tYWluVmFsdWUgPSB2YWx1ZSAvIChtYXggKyBtaW4pXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4oZG9tYWluVmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckNvbnRleHQuZmlsbFN0eWxlID0gYHJnYmEoJHtyfSwgJHtnfSwgJHtifSwgJHtkb21haW5WYWx1ZX0pYFxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJDb250ZXh0LmZpbGxTdHlsZSA9ICcjRkZGJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyQ29udGV4dC5hcmMobngsIG55LCByYWRpdXMgLyAyLCAwLCAyICogTWF0aC5QSSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJhZGl1cyA+IDMgJiYgbm9kZVN0cm9rZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJDb250ZXh0LnN0cm9rZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyQ29udGV4dC5maWxsKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbmRlck5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlck5vZGUodGhpcy5yZW5kZXJDb250ZXh0LCBub2RlLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIGlmIChvbkVuZFJlbmRlcikge1xuICAgICAgICAgICAgICAgIG9uRW5kUmVuZGVyKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCJjb25zdCBjb2xvcnMgPSBbXG4gICAgWzYsIDU3LCAxNDNdLFxuICAgIFswLCAxMDcsIDkyXSxcbiAgICBbMjE2LCAxMzksIDBdLFxuICAgIFsxODAsIDAsIDg1XSxcbiAgICBbMTA2LCAyLCAxNDNdLFxuICAgIFsyMTYsIDEwOSwgMF0sXG4gICAgWzIsIDEwNSwgMTM0XSxcbiAgICBbMCwgMTQyLCAxMDNdLFxuICAgIFsyMDEsIDAsIDM5XSxcbiAgICBbMTM5LCAxMSwgMjE1XSxcbiAgICBbMTcxLCAxNDEsIDBdXG5dXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFic3RyYWN0UmVuZGVyZXIge1xuXG4gICAgY29uc3RydWN0b3IoY29uZmlnLCBpbml0RGF0YSkge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICB4UGFkZGluZyxcbiAgICAgICAgICAgIHlQYWRkaW5nLFxuICAgICAgICAgICAgeE9mZnNldCxcbiAgICAgICAgICAgIGxheWVyID0ge31cbiAgICAgICAgfSA9IGNvbmZpZztcbiAgICAgICAgY29uc3QgeyBsYXllckFyciB9ID0gaW5pdERhdGE7XG5cbiAgICAgICAgbGV0IG1heEhlaWdodCA9ICh5UGFkZGluZyB8fCAxKSAqIDI7XG4gICAgICAgIGxldCBjeCA9ICh4UGFkZGluZyB8fCAwKSArICh4T2Zmc2V0IHx8IDApXG5cbiAgICAgICAgZnVuY3Rpb24gcHJvY2Vzc0NvbHVtbihseXIsIGNvbCA9IDApIHtcbiAgICAgICAgICAgIGx5ci5jb2x1bW4gPSBjb2w7XG4gICAgICAgICAgICBseXIucHJldmlvdXNDb2x1bW4uZm9yRWFjaChsID0+IHtcbiAgICAgICAgICAgICAgICBwcm9jZXNzQ29sdW1uKGwsIGNvbCArIDEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBwcm9jZXNzQ29sdW1uKGxheWVyQXJyW2xheWVyQXJyLmxlbmd0aCAtIDFdKTtcblxuICAgICAgICBsYXllckFyci5mb3JFYWNoKChsLCBsaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgbmFtZSwgc2hhcGUsIHByZXZpb3VzQ29sdW1uIH0gPSBsO1xuICAgICAgICAgICAgdGhpcy5vdXRwdXRMYXllciA9IGw7XG4gICAgICAgICAgICBjb25zdCBjdXN0b21Db25maWcgPSBsYXllcltuYW1lXSB8fCB7fTtcblxuICAgICAgICAgICAgY29uc3QgbGF5ZXJDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBjb25maWcsIGN1c3RvbUNvbmZpZylcbiAgICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgICAgICByYWRpdXMsXG4gICAgICAgICAgICAgICAgbm9kZVBhZGRpbmcsXG4gICAgICAgICAgICAgICAgbGF5ZXJQYWRkaW5nLFxuICAgICAgICAgICAgICAgIGdyb3VwUGFkZGluZyxcbiAgICAgICAgICAgICAgICBkb21haW4gPSBbMCwgMV0sXG4gICAgICAgICAgICAgICAgcmVuZGVyTGlua3MsXG4gICAgICAgICAgICAgICAgcmVuZGVyTm9kZSxcbiAgICAgICAgICAgICAgICBub2RlU3Ryb2tlLFxuICAgICAgICAgICAgICAgIHJlc2hhcGUgfSA9IGxheWVyQ29uZmlnO1xuXG4gICAgICAgICAgICBjb25zdCBjb2xvciA9IGxheWVyQ29uZmlnLmNvbG9yIHx8IChsaW5kZXggPCBjb2xvcnMubGVuZ3RoID8gY29sb3JzW2xpbmRleF0gOiBbMCwgMCwgMF0pO1xuICAgICAgICAgICAgbGV0IFtyb3dzLCBjb2xzLCBncm91cHNdID0gT2JqZWN0LmFzc2lnbihbMSwgMSwgMV0sIHNoYXBlLnNsaWNlKDEpKTtcbiAgICAgICAgICAgIGNvbnN0IHRvdGFsTm9kZXMgPSByb3dzICogY29scyAqIGdyb3VwcztcblxuICAgICAgICAgICAgaWYgKHJlc2hhcGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBbbnIsIG5jLCBuZ10gPSBPYmplY3QuYXNzaWduKFsxLCAxLCAxXSwgcmVzaGFwZSk7XG4gICAgICAgICAgICAgICAgaWYgKG5yICogbmMgKiBuZyAhPT0gdG90YWxOb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuYWJsZSB0byByZXNoYXBlIGZyb20gWyR7cm93c30sICR7Y29sc30sICR7Z3JvdXBzfV0gdG8gWyR7bnJ9LCAke25jfSwgJHtuZ31dYClcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByb3dzID0gbnI7XG4gICAgICAgICAgICAgICAgY29scyA9IG5jO1xuICAgICAgICAgICAgICAgIGdyb3VwcyA9IG5nO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjeCArPSBsYXllclBhZGRpbmc7XG5cbiAgICAgICAgICAgIGNvbnN0IHN0ZXAgPSByYWRpdXMgKyBub2RlUGFkZGluZztcbiAgICAgICAgICAgIGNvbnN0IHdpZHRoID0gbGF5ZXJQYWRkaW5nICsgY29scyAqIHN0ZXBcbiAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gW107XG4gICAgICAgICAgICBsZXQgaGVpZ2h0ID0gMDtcblxuICAgICAgICAgICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgcm93czsgcm93KyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCBjb2xzOyBjb2wrKykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBncm91cCA9IDA7IGdyb3VwIDwgZ3JvdXBzOyBncm91cCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB5ID0gcmFkaXVzICsgcm93ICogc3RlcCArIGdyb3VwICogcm93cyAqIHN0ZXAgKyBncm91cCAqIGdyb3VwUGFkZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeDogY3ggKyBjb2wgKiBzdGVwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFkaXVzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IHk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGhlaWdodCArPSBncm91cFBhZGRpbmcgKyByYWRpdXM7XG4gICAgICAgICAgICBtYXhIZWlnaHQgPSBNYXRoLm1heChtYXhIZWlnaHQsIGhlaWdodCk7XG5cbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24obCwge1xuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgeDogY3gsXG4gICAgICAgICAgICAgICAgbGF5ZXJXaWR0aDogd2lkdGgsXG4gICAgICAgICAgICAgICAgbGF5ZXJIZWlnaHQ6IGhlaWdodCxcbiAgICAgICAgICAgICAgICByYWRpdXMsXG4gICAgICAgICAgICAgICAgbm9kZXMsXG4gICAgICAgICAgICAgICAgZG9tYWluLFxuICAgICAgICAgICAgICAgIHJlbmRlckxpbmtzLFxuICAgICAgICAgICAgICAgIHJlbmRlck5vZGUsXG4gICAgICAgICAgICAgICAgbm9kZVN0cm9rZSxcbiAgICAgICAgICAgICAgICBjb2xvcixcbiAgICAgICAgICAgICAgICBwcmV2aW91c0xheWVyczogcHJldmlvdXNDb2x1bW4ubWFwKGx5ciA9PiBseXIubmFtZSlcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIGN4ICs9IHdpZHRoO1xuICAgICAgICB9KTtcblxuICAgICAgICBjeCArPSB4UGFkZGluZyB8fCAwO1xuXG4gICAgICAgIGxheWVyQXJyLmZvckVhY2gobCA9PiB7XG4gICAgICAgICAgICBjb25zdCBvZmZzZXRZID0gTWF0aC5mbG9vcigobWF4SGVpZ2h0IC0gbC5sYXllckhlaWdodCkgLyAyKTtcbiAgICAgICAgICAgIGwubm9kZXMuZm9yRWFjaChuZCA9PiBuZC55ICs9IG9mZnNldFkpO1xuICAgICAgICB9KTtcblxuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMsIHsgd2lkdGg6IGN4LCBoZWlnaHQ6IG1heEhlaWdodCB9KTtcblxuICAgICAgICB0aGlzLmxheWVycyA9IGxheWVyQXJyO1xuICAgICAgICB0aGlzLmxheWVyc01hcCA9IGxheWVyQXJyLnJlZHVjZSgobWVtbywgaXRlbSkgPT4ge1xuICAgICAgICAgICAgbWVtb1tpdGVtLm5hbWVdID0gaXRlbTtcbiAgICAgICAgICAgIHJldHVybiBtZW1vO1xuICAgICAgICB9LCB7fSk7XG4gICAgfVxuXG4gICAgdXBkYXRlKG1vZGVsLCBpbnB1dCkge1xuICAgICAgICBpZiAoaW5wdXQpIHtcbiAgICAgICAgICAgIG1vZGVsLmlucHV0cy5mb3JFYWNoKChpbnB1dExheWVyLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHN5bnRoZXRpY0xheWVyID0gdGhpcy5sYXllcnNNYXBbaW5wdXRMYXllci5uYW1lXTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUxheWVyVmFsdWVzKHN5bnRoZXRpY0xheWVyLCBpbnB1dFtpbmRleF0uZGF0YVN5bmMoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudXBkYXRlTGF5ZXJWYWx1ZXModGhpcy5vdXRwdXRMYXllciwgbW9kZWwub3V0cHV0RGF0YSk7XG4gICAgfVxuXG4gICAgdXBkYXRlTGF5ZXJWYWx1ZXMobGF5ZXIsIGRhdGEpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsYXllci5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbGF5ZXIubm9kZXNbaV0udmFsdWUgPSBkYXRhW2ldO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdXBkYXRlVmFsdWVzKGxheWVyKSB7XG4gICAgICAgIGNvbnN0IHN5bnRoZXRpY0xheWVyID0gdGhpcy5sYXllcnNNYXBbbGF5ZXIubmFtZV07XG4gICAgICAgIHN5bnRoZXRpY0xheWVyLndlaWdodHMgPSBsYXllci53ZWlnaHRzO1xuICAgICAgICBzeW50aGV0aWNMYXllci5wcmV2aW91c0NvbHVtbi5mb3JFYWNoKChjb2wsIGlkeCkgPT4ge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVMYXllclZhbHVlcyhjb2wsIGxheWVyLmFjdGl2YXRpb25zW2lkeF0pO1xuICAgICAgICB9KVxuXG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQge1xuICAgIHJlbmRlcmVyOiAnY2FudmFzJyxcblxuICAgIHJhZGl1czogNixcbiAgICBub2RlUGFkZGluZzogMixcbiAgICBsYXllclBhZGRpbmc6IDIwLFxuICAgIGdyb3VwUGFkZGluZzogMSxcbiAgICBcbiAgICB4UGFkZGluZzogMTAsXG4gICAgeVBhZGRpbmc6IDEwLFxuICAgXG4gICAgcmVuZGVyTGlua3M6IGZhbHNlLFxuICAgIHBsb3RBY3RpdmF0aW9uczogZmFsc2UsXG4gICAgbm9kZVN0cm9rZTogdHJ1ZSxcblxuICAgIG9uUmVuZGVyZXJJbml0aWFsaXplZDogcmVuZGVyZXIgPT4ge1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHJlbmRlcmVyLmNhbnZhcyk7XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==